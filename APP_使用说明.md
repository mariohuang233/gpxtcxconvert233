# GPX转TCX 图形界面应用使用说明

## 概述

这是一个简单易用的GPX到TCX格式转换工具，提供了图形界面和一站式转换功能。支持单文件转换和批量处理，适合在macOS系统上使用。

## 文件说明

### 核心文件
- `gpx_converter_app.py` - 主要的图形界面应用
- `gpx_to_tcx.py` - 转换引擎（必需）
- `run_app.py` - 应用启动器
- `build_mac_app.py` - macOS应用打包工具

## 使用方法

### 方法一：直接运行Python应用

1. **启动应用**
   ```bash
   python3 run_app.py
   ```
   或者直接运行：
   ```bash
   python3 gpx_converter_app.py
   ```

2. **使用界面**
   - 点击"浏览"按钮选择GPX文件
   - 选择输出目录（默认为输入文件所在目录）
   - 可选：勾选"自定义开始时间"并设置时间
   - 可选：勾选"批量处理"来转换目录中所有GPX文件

3. **配置运动数据**（可选）
   - **配速设置**: 选择自动、预设配速或自定义配速
   - **心率配置**: 选择合适的心率区间或自定义范围
   - **步频控制**: 设置步频范围或使用自动模式
   - **功率数据**: 配置功率区间或选择自动生成
   - **运动类型**: 选择对应的运动类型（跑步、骑行等）
   - **预设配置**: 可选择轻松、中等、高强度预设方案

4. **开始转换**
   - 点击"开始转换"按钮
   - 系统会显示使用的配置参数

5. **查看结果**
   - 转换过程会在日志区域显示
   - 完成后可点击"打开输出目录"查看生成的TCX文件

### 方法二：打包成macOS应用

1. **安装依赖**
   ```bash
   pip install py2app
   ```

2. **构建应用**
   ```bash
   python3 build_mac_app.py
   ```

3. **安装应用**
   - 构建完成后，在`dist`文件夹中找到`GPX转TCX转换器.app`
   - 将应用拖拽到"应用程序"文件夹
   - 双击运行

## 功能特点

### 界面功能
- **直观界面**: 简洁易用的图形界面，布局优化
- **拖拽支持**: 支持拖拽GPX文件到应用窗口
- **一键转换**: 单击按钮即可完成转换
- **批量处理**: 支持批量转换多个GPX文件
- **自定义时间**: 可设置运动开始时间
- **实时日志**: 显示转换过程和结果
- **进度显示**: 实时显示转换进度

### 运动数据配置
- **配速设置**: 支持自动、预设配速(3:30-6:00)或自定义配速
- **心率配置**: 可选择自动、不同强度心率区间或自定义范围
- **步频控制**: 支持自动、预设步频范围或自定义设置
- **功率数据**: 可配置自动、不同功率区间或自定义功率范围
- **运动类型**: 支持跑步、骑行、游泳、健走、登山等多种运动
- **预设配置**: 提供轻松、中等、高强度等预设配置方案

### 转换功能
- ✅ 单文件转换
- ✅ 批量转换目录中所有GPX文件
- ✅ 自定义开始时间
- ✅ 自动优化配速和运动数据
- ✅ 生成完整的TCX运动文件

### 数据质量
- ✅ 修复配速异常问题
- ✅ 生成合理的步频数据（52-70范围）
- ✅ 模拟心率数据（120-170范围）
- ✅ 计算功率数据
- ✅ 优化时间戳

## 系统要求

- macOS 10.12 或更高版本
- Python 3.6 或更高版本
- tkinter（通常随Python安装）

## 故障排除

### 常见问题

1. **"无法导入GPX转TCX模块"**
   - 确保`gpx_to_tcx.py`文件存在于同一目录
   - 检查文件权限

2. **"转换失败"**
   - 检查GPX文件格式是否正确
   - 确保有足够的磁盘空间
   - 查看日志区域的详细错误信息

3. **应用无法启动**
   - 确保Python 3已正确安装
   - 运行`python3 --version`检查版本
   - 尝试在终端中直接运行应用

4. **打包应用失败**
   - 确保已安装py2app：`pip install py2app`
   - 检查是否有足够的磁盘空间
   - 尝试清理之前的构建文件

### 获取帮助

如果遇到问题：
1. 查看应用内的日志信息
2. 检查终端输出的错误信息
3. 确认所有必需文件都存在

## 使用技巧

### 基础操作
1. **批量转换**
   - 将所有GPX文件放在同一个文件夹中
   - 选择该文件夹作为输出目录
   - 勾选"批量处理"选项

2. **自定义时间**
   - 用于设置运动开始时间
   - 格式：YYYY-MM-DD HH:MM:SS
   - 例如：2025-01-15 08:30:00

3. **文件管理**
   - 建议为每次转换创建单独的输出文件夹
   - TCX文件名会自动基于GPX文件名生成

4. **格式兼容**
   - 生成的TCX文件兼容大多数运动平台（如Strava、Garmin Connect等）

### 运动数据配置技巧
1. **配速设置**: 
   - 跑步建议配速：轻松跑5:30-6:00，节奏跑4:30-5:00，间歇跑3:30-4:00
   - 自定义配速格式：分:秒（如4:30表示每公里4分30秒）

2. **心率配置**:
   - 轻松强度：120-140 bpm
   - 中等强度：140-160 bpm  
   - 高强度：160-180 bpm
   - 可根据个人最大心率调整

3. **步频设置**:
   - 跑步推荐步频：160-180 spm
   - 健走推荐步频：120-140 spm

4. **功率配置**:
   - 骑行功率：轻松100-150W，中等150-250W，高强度250-350W
   - 跑步功率：轻松200-250W，中等250-300W，高强度300-400W

5. **预设配置使用**:
   - 轻松：适合恢复训练和长距离有氧
   - 中等：适合节奏跑和一般训练
   - 高强度：适合间歇训练和比赛

## 版本信息

- 版本：1.0.0
- 更新日期：2025年1月
- 兼容性：macOS, Windows, Linux

---

**注意**：首次运行打包的macOS应用时，系统可能会显示安全警告。请在"系统偏好设置" > "安全性与隐私"中允许应用运行。